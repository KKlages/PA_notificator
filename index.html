<body>
    <div class="container">
        <h1>ðŸŽ® Planetary Annihilation Status</h1>
        
        <div id="player1-status" class="status-box unavailable">
            <div class="icon">ðŸ”´</div>
            <h2>Player 1</h2>
            <p>Not Available</p>
            <div class="last-update"></div>
            <button onclick="toggleStatus('player1')">Toggle My Status</button>
        </div>
        
        <div id="player2-status" class="status-box unavailable">
            <div class="icon">ðŸ”´</div>
            <h2>Player 2</h2>
            <p>Not Available</p>
            <div class="last-update"></div>
            <button onclick="toggleStatus('player2')">Toggle My Status</button>
        </div>
    </div>

    <script>
        const API_URL = 'https://your-backend-url.com'; // Replace with your actual backend URL

        function updateStatus(userId, data) {
            const statusBox = document.getElementById(`${userId}-status`);
            const icon = statusBox.querySelector('.icon');
            const text = statusBox.querySelector('p');
            const lastUpdate = statusBox.querySelector('.last-update');
            
            if (data.available) {
                statusBox.className = 'status-box available';
                icon.textContent = 'ðŸŸ¢';
                text.textContent = 'READY FOR PA!';
            } else {
                statusBox.className = 'status-box unavailable';
                icon.textContent = 'ðŸ”´';
                text.textContent = 'Not Available';
            }
            
            if (data.last_update) {
                const updateTime = new Date(data.last_update);
                lastUpdate.textContent = `Last update: ${updateTime.toLocaleTimeString()}`;
            }
        }
        
        async function fetchStatus() {
            try {
                const response = await fetch(`${API_URL}/all_status`);
                const data = await response.json();
                updateStatus('player1', data.player1);
                updateStatus('player2', data.player2);
            } catch (error) {
                console.error('Error fetching status:', error);
            }
        }

        async function toggleStatus(userId) {
            try {
                const response = await fetch(`${API_URL}/toggle/${userId}`, {
                    method: 'POST'
                });
                if (response.ok) {
                    const data = await response.json();
                    updateStatus(userId, data);
                } else {
                    console.error('Error toggling status');
                }
            } catch (error) {
                console.error('Error toggling status:', error);
            }
        }
        
        // Poll every 3 seconds
        setInterval(fetchStatus, 3000);
        fetchStatus(); // Initial fetch
    </script>
</body>
